(window.webpackJsonp=window.webpackJsonp||[]).push([[301],{856:function(t,e,s){"use strict";s.r(e);var a=s(10),o=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[s("code",[t._v("React Native")]),t._v(" 应用程序开发完成后，需要先打包一个测试版，由测试人员安装应用并测试。对于 "),s("code",[t._v("iOS")]),t._v(" 应用，一般来说，开发者如果需要将应用安装到某些用户的设备上，就需要将应用导出为这些设备可以直接安装的安装包（"),s("code",[t._v(".ipa")]),t._v(" 文件）。本文总结了如何打包 "),s("code",[t._v("ipa")]),t._v(" 并发布到应用内测分发平台供安装测试")])]),t._v(" "),s("h2",{attrs:{id:"一、应用程序打包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、应用程序打包"}},[t._v("#")]),t._v(" 一、应用程序打包")]),t._v(" "),s("blockquote",[s("p",[t._v("开发 "),s("code",[t._v("React Native")]),t._v(" 应用时，js 代码和图片资源通过 "),s("code",[t._v("Debug Server")]),t._v(" 提供，但是当我们需要发布应用时，就需要将 js 等资源和应用一起打包")])]),t._v(" "),s("h3",{attrs:{id:"_1-1-打包离线资源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-打包离线资源"}},[t._v("#")]),t._v(" 1.1 打包离线资源")]),t._v(" "),s("blockquote",[s("p",[t._v("通过 "),s("code",[t._v("react-native bundle")]),t._v(" 命令可以打包离线资源。为了日后把打包方便，我们把打包指令填在下"),s("code",[t._v("package.json")]),t._v("下")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"start"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node node_modules/react-native/local-cli/cli.js start"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"test"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jest"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"bundle-ios"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node node_modules/react-native/local-cli/cli.js bundle --entry-file index.js --platform ios --dev false --bundle-output ./ios/bundle/index.jsbundle --assets-dest ./ios/bundle"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("blockquote",[s("p",[s("code",[t._v("bundle-ios")]),t._v("命令参数含义")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("--entry-file")]),t._v("：入口文件。")]),t._v(" "),s("li",[s("code",[t._v("--platform")]),t._v("：平台名称（ios或者android）。")]),t._v(" "),s("li",[s("code",[t._v("--dev")]),t._v("：是否是开发模式，设置为 false 的时候将会对 JavaScript 代码进行优化处理。")]),t._v(" "),s("li",[s("code",[t._v("--bundle-output")]),t._v("：生成的 "),s("code",[t._v("jsbundle")]),t._v(" 文件的名称。")]),t._v(" "),s("li",[s("code",[t._v("--assets-dest")]),t._v("：图片以及其他资源存放的目录")])]),t._v(" "),s("blockquote",[s("p",[t._v("这样打包只需要在根目录下输入"),s("code",[t._v("npm run bundle-ios")]),t._v(" 即可（切记一定要先在"),s("code",[t._v("项目--\x3eios下新建bundle")]),t._v("文件夹，不然会报错）")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/711.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("之后你会发现bundle文件下面已经有了内容（如下图）")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/712.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"_1-2-添加离线资源到项目中"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-添加离线资源到项目中"}},[t._v("#")]),t._v(" 1.2 添加离线资源到项目中")]),t._v(" "),s("blockquote",[s("p",[t._v("在"),s("code",[t._v("Xcode")]),t._v("中添加资源到项目中，必须使用"),s("code",[t._v("Create folder references")]),t._v("的方式(也就是文件夹的方式)添加"),s("code",[t._v("bundle")]),t._v("文件\n夹")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/713.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("必须使用"),s("code",[t._v("Create folder references")]),t._v("的方式添加：")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/714.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("添加成功后"),s("code",[t._v("bundle")]),t._v("文件夹为蓝色（如下图）")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/715.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"_1-3-修改-appdelegate-m-文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-修改-appdelegate-m-文件"}},[t._v("#")]),t._v(" 1.3 修改 AppDelegate.m 文件")]),t._v(" "),s("blockquote",[s("p",[t._v("在开发的过程中可以在这里配置"),s("code",[t._v("Debug Server")]),t._v("的地址，当发布上线的时候，就需要使用离线的"),s("code",[t._v("jsbundle")]),t._v("文件，因此需要设置"),s("code",[t._v("jsCodeLocation")]),t._v("为本地的离线"),s("code",[t._v("jsbundle")]),t._v("。")])]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BOOL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UIApplication "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("application didFinishLaunchingWithOptions"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NSDictionary "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("launchOptions\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  NSURL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("jsCodeLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//  jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@"index" fallbackResource:nil];')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//  jsCodeLocation = [NSURL URLWithString:@"http://192.0.0.0:8081/index.bundle?platform=ios&dev=true"];//真机Hot reloading')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("ifdef")]),t._v(" DEBUG")]),t._v("\n     jsCodeLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("RCTBundleURLProvider sharedSettings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" jsBundleURLForBundleRoot"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"index"')]),t._v(" fallbackResource"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("nil"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//开发调试")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("else")])]),t._v("\n    jsCodeLocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("NSBundle mainBundle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" URLForResource"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bundle/index"')]),t._v(" withExtension"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jsbundle"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//上线打包")]),t._v("\n  \n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("endif")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"二、ios证书配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、ios证书配置"}},[t._v("#")]),t._v(" 二、iOS证书配置")]),t._v(" "),s("blockquote",[s("p",[t._v("建议阅读这篇文章更详细。"),s("a",{attrs:{href:"http://blog.poetries.top/2019/10/03/rn-ios-cert-config",target:"_blank",rel:"noopener noreferrer"}},[t._v("React Native打包前凑之iOS证书配置"),s("OutboundLink")],1)])]),t._v(" "),s("blockquote",[s("p",[t._v("首先你的有一个开发者账号才可以进行以下步骤")])]),t._v(" "),s("blockquote",[s("p",[t._v("在mac上搜索钥匙串打开")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/726.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/727.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("到 "),s("code",[t._v("https://developer.apple.com")]),t._v(" 去申请证书")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/728.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("新建证书")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/729.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/730.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("上传之前的钥匙串文件")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/731.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("下载证书。双击即可安装到钥匙串中")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/732.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/733.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("新建"),s("code",[t._v("Identifiers")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/734.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/735.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/736.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/737.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("新增Profiles 把设备证书以及id关联起来")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/738.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/739.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/740.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/741.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/742.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/743.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("到此证书部分添加完毕。接下来是根据已经配置的证书去打包。xcode会自动同步证书信息过来")])]),t._v(" "),s("h2",{attrs:{id:"三、xcode-打包-ipa"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、xcode-打包-ipa"}},[t._v("#")]),t._v(" 三、Xcode 打包 ipa")]),t._v(" "),s("ol",[s("li",[t._v("在 "),s("code",[t._v("Xcode")]),t._v(" 添加前面申请证书的开发者账号（"),s("code",[t._v("Xcode->Preferences->Accounts")]),t._v("）")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/716.png",alt:""}})]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("这里的 "),s("code",[t._v("Bundle Idetifier")]),t._v(" 应该为之前在开发者平台上添加的 "),s("code",[t._v("App ID")]),t._v(" 如下图")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/717.png",alt:""}})]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("配置一下"),s("code",[t._v("code sign")]),t._v(" 。选择 "),s("code",[t._v("Code Signing Identity")]),t._v(" 安装证书")])]),t._v(" "),s("blockquote",[s("p",[t._v("程序会自动选择设置")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/718.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("或者手动选择证书")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/719.png",alt:""}})]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[t._v("点击设备，选择通用 iOS 设备")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/720.png",alt:""}})]),t._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[t._v("点击 "),s("code",[t._v("Product->Archive")]),t._v(" 开始打包")])]),t._v(" "),s("blockquote",[s("p",[t._v("打包完成后如下")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/721.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("点击"),s("code",[t._v("distribute App")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/ionic/16.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/ionic/17.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/ionic/18.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/ionic/19.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("最后打包成"),s("code",[t._v("ipa")]),t._v("文件")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/725.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"四、发布到内测分发平台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、发布到内测分发平台"}},[t._v("#")]),t._v(" 四、发布到内测分发平台")]),t._v(" "),s("blockquote",[s("p",[t._v("由于新版的 iTunes 没有了应用程序选项，所以无法通过 iTunes 安装 App 到手机中。比较方便的方式是将应用发布到内测分发平台，然后扫码即可下载。目前我听得比较多的平台就是蒲公英和 fir.im，不过这两个平台都需要实名认证，有点蛋疼。具体使用哪个平台自己甄选就行，这里推荐一个不需要认证的国外平台 https://www.diawi.com")])]),t._v(" "),s("h3",{attrs:{id:"_4-1-ipa安装到手机上"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-ipa安装到手机上"}},[t._v("#")]),t._v(" 4.1 ipa安装到手机上")]),t._v(" "),s("blockquote",[s("p",[t._v("在Xcode的导航栏上选择"),s("code",[t._v("window->Devices and Simulators")]),t._v("，点击弹出页面里面的+号，选择"),s("code",[t._v("ipa")]),t._v("所在的文件夹,添加"),s("code",[t._v("ipa")]),t._v("，安装成功")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/709.png",alt:""}}),t._v(" "),s("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/710.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("以上只是测试版本打包，打包成"),s("code",[t._v("disctibute App")]),t._v("发布版本同理，这里不再赘述")])])])}),[],!1,null,null,null);e.default=o.exports}}]);