(window.webpackJsonp=window.webpackJsonp||[]).push([[383],{1351:function(t,s,a){"use strict";a.r(s);var e=a(10),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"一、小程序开发框架"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、小程序开发框架"}},[t._v("#")]),t._v(" 一、小程序开发框架")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/1.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("Vue-like、React-like 代码，如何在小程序中运行?")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/2.png",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"_1-1-基本原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-基本原理"}},[t._v("#")]),t._v(" 1.1 基本原理")]),t._v(" "),a("ul",[a("li",[t._v("编译时处理（转译成小程序语法）")]),t._v(" "),a("li",[t._v("运行时适配（管理生命周期、数据，处理事件等）")])]),t._v(" "),a("p",[a("strong",[t._v("编译原理")])]),t._v(" "),a("blockquote",[a("p",[t._v("源代码->词法/语法/语义分析->抽象语法树->转换->目标代码")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/3.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("抽象语法树 AST")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/4.png",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"_1-2-小程序框架多端支持情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-小程序框架多端支持情况"}},[t._v("#")]),t._v(" 1.2 小程序框架多端支持情况")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/5.png",alt:"image.png"}})]),t._v(" "),a("h2",{attrs:{id:"二、taro原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、taro原理"}},[t._v("#")]),t._v(" 二、Taro原理")]),t._v(" "),a("blockquote",[a("p",[t._v("Taro: 多端统一开发框架，支持用 React 的开发方式编写一次代\n码，生成能运行在微信小程序、H5、React Native 等的应用")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/6.png",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/7.png",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/8.png",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/9.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("多端能力：提供对应端的runtime、组件、redux、router等实现")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/10.png",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/11.png",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/12.png",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/13.png",alt:"image.png"}})]),t._v(" "),a("ul",[a("li",[t._v("提供相应端的 "),a("code",[t._v("Runtime")]),t._v(" 实现，具备适配 "),a("code",[t._v("API")]),t._v(" 的能力")]),t._v(" "),a("li",[t._v("提供统一的基础组件，编译时替换为相应端的组件实现")])]),t._v(" "),a("h2",{attrs:{id:"三、taro项目中遇到的坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、taro项目中遇到的坑"}},[t._v("#")]),t._v(" 三、Taro项目中遇到的坑")]),t._v(" "),a("h3",{attrs:{id:"_3-1-一些坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-一些坑"}},[t._v("#")]),t._v(" 3.1 一些坑")]),t._v(" "),a("p",[a("strong",[t._v("1、React-like，不完全等同 React")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/14.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("2、端能力差异不可避免：某些功能在相应端上没有支持")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/15.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("3、样式支持、写法上存在差异")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/16.png",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/17.png",alt:"image.png"}}),t._v(" "),a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/18.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("4、还没有真正支持多端的 UI 组件库能在 Taro 上使用")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/19.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("5、React Native 的 view 不支持 click 事件，需要用 Touchable 组件")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/20.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("6、React Native 不支持 text-overflow，而是提供原生支持（Text 组件传入 numberOfLines={num} 属性）")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("Taro")]),t._v(" 目前没有暴露原生 "),a("code",[t._v("RN")]),t._v(" T"),a("code",[t._v("ext")]),t._v(" 组件的 "),a("code",[t._v("numberOfLines")]),t._v(" 属性。因此目前通过 "),a("code",[t._v("Text")]),t._v(" 基础组件没法实现多端统一的文本截断")])]),t._v(" "),a("p",[a("strong",[t._v("H5情况较为乐观")])]),t._v(" "),a("ul",[a("li",[t._v("主要差异1: 小程序的页面、组件样式都是独立的，H5会受同名样式影响")]),t._v(" "),a("li",[t._v("主要差异2: 小程序的组件多了一层标签")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/21.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("7、多端要求较高")])]),t._v(" "),a("ul",[a("li",[t._v("对不同端的具体差异有所了解")]),t._v(" "),a("li",[t._v("样式实现较为苛刻，需兼顾多端、有所取舍")]),t._v(" "),a("li",[t._v("端能力差异可能需要自己填坑")])]),t._v(" "),a("p",[a("strong",[t._v("8、多端填坑方式")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/20190930/22.png",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("多端实践经验")])]),t._v(" "),a("ul",[a("li",[t._v("对多端差异做好封装")]),t._v(" "),a("li",[t._v("采用 BEM 命名方式管理样式")]),t._v(" "),a("li",[t._v("采用全局样式维护基础组件 "),a("code",[t._v("@taro/components")]),t._v(" 的样式")]),t._v(" "),a("li",[t._v("基于 "),a("code",[t._v("@taro/components")]),t._v(" 自行封装组件库")])]),t._v(" "),a("h3",{attrs:{id:"_3-2-注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-注意事项"}},[t._v("#")]),t._v(" 3.2 注意事项")]),t._v(" "),a("ul",[a("li",[t._v("函数需要"),a("code",[t._v("on+函数名")]),t._v("来规范命名")]),t._v(" "),a("li",[t._v("子组件中接收的"),a("code",[t._v("props")]),t._v("需要定义"),a("code",[t._v("defaultProps")]),t._v("。否则小程序端报错")]),t._v(" "),a("li",[t._v("在 "),a("code",[t._v("Taro")]),t._v(" 中，"),a("code",[t._v("JS")]),t._v(" 代码里必须书写单引号，特别是 JSX 中，如果出现双引号，可能会导致编译错误")]),t._v(" "),a("li",[a("code",[t._v("css")]),t._v("样式单位写"),a("code",[t._v("PX")]),t._v("大写会转成"),a("code",[t._v("rem")]),t._v("单位")]),t._v(" "),a("li",[t._v("根据环境变量引入不同平台组件、编译到对应平台")]),t._v(" "),a("li",[t._v("小程序端不支持在"),a("code",[t._v("render()")]),t._v("之外定义jsx。比如在外面"),a("code",[t._v("renderForm()")])]),t._v(" "),a("li",[t._v("页面布局：拆分组件方法--由上到下，由左到右拆分")]),t._v(" "),a("li",[t._v("Taro 目前还没有支持 "),a("code",[t._v("React.Fragment")]),t._v(" 语法")]),t._v(" "),a("li",[t._v("运行时 报缺少包，需要要在 "),a("code",[t._v(".rn_temp")]),t._v(" 目录里面安装")]),t._v(" "),a("li",[t._v("文字要包在 "),a("code",[t._v("Text")]),t._v(" 组件里面，否则不显示")]),t._v(" "),a("li",[a("code",[t._v("position:fixed")]),t._v(" "),a("code",[t._v("React Native")]),t._v(" 不支持")]),t._v(" "),a("li",[a("code",[t._v("Animation")]),t._v(" 和 "),a("code",[t._v("transform")]),t._v(" "),a("code",[t._v("React Native")]),t._v(" 动画不支持")]),t._v(" "),a("li",[t._v("状态更新一定是异步的。React的状态更新不一定是异步")])]),t._v(" "),a("h2",{attrs:{id:"四、技巧"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、技巧"}},[t._v("#")]),t._v(" 四、技巧")]),t._v(" "),a("h3",{attrs:{id:"_4-1-样式文件条件编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-样式文件条件编译"}},[t._v("#")]),t._v(" 4.1 样式文件条件编译")]),t._v(" "),a("blockquote",[a("p",[t._v("假设目录中同时存在以下文件：")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("- index.scss\n- index.rn.scss\n")])])]),a("blockquote",[a("p",[t._v("当在 "),a("code",[t._v("JS")]),t._v("文件中引用样式文件："),a("code",[t._v("import './index.scss'")]),t._v(" 时，"),a("code",[t._v("RN")]),t._v(" 平台会找到并引入 "),a("code",[t._v("index.rn.scss")]),t._v("，其他平台会引入："),a("code",[t._v("index.scss")]),t._v("，方便大家书写跨端样式，更好地兼容 "),a("code",[t._v("RN")])])]),t._v(" "),a("h3",{attrs:{id:"_4-2-内置环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-内置环境变量"}},[t._v("#")]),t._v(" 4.2 内置环境变量")]),t._v(" "),a("p",[a("strong",[t._v("process.env.TARO_ENV")])]),t._v(" "),a("blockquote",[a("p",[t._v("用于判断当前编译类型，目前有 "),a("code",[t._v("weapp / swan / alipay / h5 / rn / tt")]),t._v("六个取值，可以通过这个变量来书写对应一些不同环境下的代码，在编译时会将不属于当前编译类型的代码去掉，只保留当前编译类型下的代码，例如想在微信小程序和 H5 端分别引用不同资源")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TARO_ENV")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'weapp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path/to/weapp/name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TARO_ENV")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h5'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path/to/h5/name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("同时也可以在 "),a("code",[t._v("JSX")]),t._v(" 中使用，决定不同端要加载的组件")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("View"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TARO_ENV")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'weapp'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ScrollViewWeapp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TARO_ENV")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h5'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ScrollViewH5 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("View"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_4-3-统一接口的多端文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-统一接口的多端文件"}},[t._v("#")]),t._v(" 4.3 统一接口的多端文件")]),t._v(" "),a("p",[a("strong",[t._v("多端组件")])]),t._v(" "),a("ul",[a("li",[t._v("假如有一个 Test 组件存在微信小程序、百度小程序和 H5 三个不同版本，那么就可以像如下组织代码")]),t._v(" "),a("li",[a("code",[t._v("test.js")]),t._v(" 文件，这是 "),a("code",[t._v("Test")]),t._v(" 组件默认的形式，编译到微信小程序、百度小程序和 H5 三端之外的端使用的版本")]),t._v(" "),a("li",[a("code",[t._v("test.h5.js")]),t._v(" 文件，这是 "),a("code",[t._v("Test")]),t._v(" 组件的 "),a("code",[t._v("H5")]),t._v(" 版本")]),t._v(" "),a("li",[a("code",[t._v("test.weapp.js")]),t._v(" 文件，这是 "),a("code",[t._v("Test")]),t._v("组件的 微信小程序 版本")]),t._v(" "),a("li",[a("code",[t._v("test.swan.js")]),t._v(" 文件，这是 "),a("code",[t._v("Test")]),t._v(" 组件的 百度小程序 版本")]),t._v(" "),a("li",[t._v("四个文件，对外暴露的是统一的接口，它们接受一致的参数，只是内部有针对各自平台的代码实现")]),t._v(" "),a("li",[t._v("而我们使用 "),a("code",[t._v("Test")]),t._v(" 组件的时候，引用的方式依然和之前保持一致，"),a("code",[t._v("import")]),t._v(" 的是不带端类型的文件名，在编译的时候会自动识别并添加端类型后缀")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("import Test from '../../components/test'\n\n<Test argA={1} argA={2} />\n")])])]),a("p",[a("strong",[t._v("多端脚本逻辑")])]),t._v(" "),a("blockquote",[a("p",[t._v("例如微信小程序上使用 "),a("code",[t._v("Taro.setNavigationBarTitle")]),t._v(" 来设置页面标题，H5 使用 "),a("code",[t._v("document.title")]),t._v("，那么可以封装一个 "),a("code",[t._v("setTitle")]),t._v(" 方法来抹平两个平台的差异")])]),t._v(" "),a("p",[t._v("增加 "),a("code",[t._v("set_title.h5.js")]),t._v("，代码如下")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTitle")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" title\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("增加 "),a("code",[t._v("set_title.weapp.js")]),t._v("，代码如下")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Taro "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tarojs/taro'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTitle")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  Taro"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setNavigationBarTitle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    title\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("调用的时候，如下使用")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("import setTitle from '../utils/set_title'\n\nsetTitle('页面标题')\n")])])]),a("h2",{attrs:{id:"五、react-native端的实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、react-native端的实践"}},[t._v("#")]),t._v(" 五、React Native端的实践")]),t._v(" "),a("blockquote",[a("p",[t._v("https://nervjs.github.io/taro/docs/react-native.html")])]),t._v(" "),a("h3",{attrs:{id:"_5-1-taro运行rn步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-taro运行rn步骤"}},[t._v("#")]),t._v(" 5.1 Taro运行RN步骤")]),t._v(" "),a("p",[a("strong",[t._v("1. 运行 yarn dev:rn")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/1480597-4032f18cd94f7871.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})]),t._v(" "),a("blockquote",[a("p",[t._v("打开 http://127.0.0.1:8081/index.bundle?platform=ios&dev=true激活编译")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/1480597-58be0cdf0230802f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})]),t._v(" "),a("p",[a("strong",[t._v("2. 下载react-native运行壳子")])]),t._v(" "),a("blockquote",[a("p",[t._v("https://github.com/poetries/react-native-shell")])]),t._v(" "),a("p",[a("strong",[t._v("3. 打开gemotion安卓模拟器")])]),t._v(" "),a("blockquote",[a("ul",[a("li",[a("a",{attrs:{href:"http://blog.poetries.top/2019/06/08/rn-summary/#1-1-2-%E5%AE%89%E5%8D%93%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("code",[t._v("adb devices")]),t._v(" 查看是否有设备在运行")])])]),t._v(" "),a("p",[a("strong",[t._v("4. 启动安卓")])]),t._v(" "),a("blockquote",[a("p",[t._v("在壳子中启动命令。"),a("code",[t._v("react-native-shell")]),t._v(" 放在哪里都可以，建议放到项目根目录即可")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("react-native run-android\n")])])]),a("p",[a("strong",[t._v("5. 打包apk")])]),t._v(" "),a("p",[t._v("把"),a("code",[t._v("react-native-shell")]),t._v("中的"),a("code",[t._v("android")]),t._v("文件加拷贝到"),a("code",[t._v(".rn_temp")]),t._v("文件中，"),a("code",[t._v("cd android")]),t._v(" 执行打包命令即可")]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"http://blog.poetries.top/2019/06/08/rn-summary/#%E5%85%AB%E3%80%81%E6%89%93%E5%8C%85",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章"),a("OutboundLink")],1)])]),t._v(" "),a("h3",{attrs:{id:"_5-2-样式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-样式"}},[t._v("#")]),t._v(" 5.2 样式")]),t._v(" "),a("blockquote",[a("p",[t._v("Note：如果要支持 "),a("code",[t._v("React Native")]),t._v(" 端，必须采用 Flex 布局，并且样式选择器仅支持类选择器，且不 支持 组合器")])]),t._v(" "),a("p",[t._v("以下选择器的写法都是不支持的，在样式转换时会自动忽略")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v(".button.button_theme_islands"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  font-style: bold"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nimg + p "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  font-style: bold"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\np ~ span "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  color: red"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ndiv "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" span "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  background-color: DodgerBlue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ndiv span "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" background-color: DodgerBlue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("样式上 "),a("code",[t._v("H5")]),t._v(" 最为灵活，小程序次之，"),a("code",[t._v("RN")]),t._v(" 最弱，统一多端样式即是对齐短板，也就是要以 "),a("code",[t._v("RN")]),t._v(" 的约束来管理样式，同时兼顾小程序的限制，核心可以用三点来概括")]),t._v(" "),a("ul",[a("li",[t._v("使用 "),a("code",[t._v("Flex")]),t._v(" 布局")]),t._v(" "),a("li",[t._v("基于 "),a("code",[t._v("BEM")]),t._v(" 写样式")]),t._v(" "),a("li",[t._v("采用 "),a("code",[t._v("style")]),t._v(" 属性覆盖组件样式")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("RN")]),t._v(" 中 "),a("code",[t._v("View")]),t._v(" 标签默认主轴方向是 "),a("code",[t._v("column")]),t._v("，如果不将其他端改成与 RN 一致，就需要在所有用到 "),a("code",[t._v("display: flex")]),t._v(" 的地方都显式声明主轴方向")])]),t._v(" "),a("h3",{attrs:{id:"_5-3-问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-问题"}},[t._v("#")]),t._v(" 5.3 问题")]),t._v(" "),a("p",[a("strong",[t._v("尽量避免在 componentDidMount 中调用 this.setState")])]),t._v(" "),a("blockquote",[a("p",[t._v("因为在 "),a("code",[t._v("componentDidMount")]),t._v(" 中调用 "),a("code",[t._v("this.setState")]),t._v(" 会导致触发更新")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Taro"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Component "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tarojs/taro'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" View"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Input "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tarojs/components'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyComponent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Component")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    myTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentDidMount")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ✗ 尽量避免，可以在 componentWillMount 中处理")]),t._v("\n      name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" isEnable "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" myTime "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("View className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("isEnable "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Text className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test_text'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("myTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("View"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("不要定义没有用到的 state")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Taro"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Component "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tarojs/taro'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" View"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Input "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tarojs/components'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyComponent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Component")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    myTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    noUsed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ✗ 没有用到")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" myTime "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("View className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Text className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test_text'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("myTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("View"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);