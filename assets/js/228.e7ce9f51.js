(window.webpackJsonp=window.webpackJsonp||[]).push([[228],{1407:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"一、javascript是单线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、javascript是单线程"}},[t._v("#")]),t._v(" 一、JavaScript是单线程")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("JavaScript")]),t._v("语言的一大特点就是单线程，也就是说，同一个时间只能做一件事")]),t._v(" "),a("li",[t._v("假定"),a("code",[t._v("JavaScript")]),t._v("同时有两个线程，一个线程在某个"),a("code",[t._v("DOM")]),t._v("节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？")]),t._v(" "),a("li",[t._v("所以，为了避免复杂性，从一诞生，"),a("code",[t._v("JavaScript")]),t._v("就是单线程，这已经成了这门语言的核心特征，将来也不会改变")]),t._v(" "),a("li",[t._v("为了利用多核"),a("code",[t._v("CPU")]),t._v("的计算能力，"),a("code",[t._v("HTML5")]),t._v("提出"),a("code",[t._v("Web Worker")]),t._v("标准，允许"),a("code",[t._v("JavaScript")]),t._v("脚本创建多个线程，但是子线程完全受主线程控制，且不得操作"),a("code",[t._v("DOM")]),t._v("。所以，这个新标准并没有改变"),a("code",[t._v("JavaScript")]),t._v("单线程的本质。")])]),t._v(" "),a("h2",{attrs:{id:"二、任务队列"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、任务队列"}},[t._v("#")]),t._v(" 二、任务队列")]),t._v(" "),a("ul",[a("li",[t._v("单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。如果前一个任务耗时很长，后一个任务就不得不一直等着")]),t._v(" "),a("li",[t._v("如果排队是因为计算量大，CPU忙不过来，倒也算了，但是很多时候CPU是闲着的，因为IO设备（输入输出设备）很慢（比如Ajax操作从网络读取数据），不得不等着结果出来，再往下执行")])]),t._v(" "),a("blockquote",[a("p",[t._v("所有任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）")])]),t._v(" "),a("ul",[a("li",[t._v("同步任务指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务")]),t._v(" "),a("li",[t._v('异步任务指的是，不进入主线程、而进入"任务队列"（'),a("code",[t._v("task queue")]),t._v('）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行')])]),t._v(" "),a("p",[a("strong",[t._v("异步执行的运行机制")])]),t._v(" "),a("ul",[a("li",[t._v("所有同步任务都在主线程上执行，形成一个执行栈")]),t._v(" "),a("li",[t._v('主线程之外，还存在一个"任务队列"（'),a("code",[t._v("task queue")]),t._v('）。只要异步任务有了运行结果，就在"任务队列"之中放置一个事件')]),t._v(" "),a("li",[t._v('一旦"执行栈"中的所有同步任务执行完毕，系统就会读取"任务队列"，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行')]),t._v(" "),a("li",[t._v("主线程不断重复上面的第三步")])]),t._v(" "),a("p",[t._v("主线程和任务队列的示意图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/316.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v('只要主线程空了，就会去读取"任务队列"，这就是'),a("code",[t._v("JavaScript")]),t._v("的运行机制。这个过程会不断重复")])]),t._v(" "),a("h2",{attrs:{id:"三、事件和回调函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、事件和回调函数"}},[t._v("#")]),t._v(" 三、事件和回调函数")]),t._v(" "),a("ul",[a("li",[t._v('"任务队列"是一个事件的队列（也可以理解成消息的队列），IO设备完成一项任务，就在"任务队列"中添加一个事件，表示相关的异步任务可以进入"执行栈"了。主线程读取"任务队列"，就是读取里面有哪些事件。')]),t._v(" "),a("li",[t._v('"任务队列"中的事件，除了IO设备的事件以外，还包括一些用户产生的事件（比如鼠标点击、页面滚动等等）。只要指定过回调函数，这些事件发生时就会进入"任务队列"，等待主线程读取。')]),t._v(" "),a("li",[t._v('所谓"回调函数"（callback），就是那些会被主线程挂起来的代码。异步任务必须指定回调函数，当主线程开始执行异步任务，就是执行对应的回调函数。')]),t._v(" "),a("li",[t._v('"任务队列"是一个先进先出的数据结构，排在前面的事件，优先被主线程读取。主线程的读取过程基本上是自动的，只要执行栈一清空，"任务队列"上第一位的事件就自动进入主线程。但是，由于存在后文提到的"定时器"功能，主线程首先要检查一下执行时间，某些事件只有到了规定的时间，才能返回主线程。')])]),t._v(" "),a("h2",{attrs:{id:"四、js中的event-loop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、js中的event-loop"}},[t._v("#")]),t._v(" 四、JS中的event loop")]),t._v(" "),a("h3",{attrs:{id:"_4-1-原理分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-原理分析"}},[t._v("#")]),t._v(" 4.1 原理分析")]),t._v(" "),a("blockquote",[a("p",[t._v('主线程从"任务队列"中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为Event Loop（事件循环）')])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/317.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v('上图中，主线程运行的时候，产生堆（heap）和栈（stack），栈中的代码调用各种外部API，它们在"任务队列"中加入各种事件（click，load，done）。只要栈中的代码执行完毕，主线程就会去读取"任务队列"，依次执行那些事件所对应的回调函数')])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("JS")]),t._v(" 在执行的过程中会产生执行环境，这些执行环境会被顺序的加入到执行栈中。如果遇到异步的代码，会被挂起并加入到 "),a("code",[t._v("Task")]),t._v("（有多种 "),a("code",[t._v("task")]),t._v("） 队列中。一旦执行栈为空，"),a("code",[t._v("Event Loop")]),t._v(" 就会从 "),a("code",[t._v("Task")]),t._v(" 队列中拿出需要执行的代码并放入执行栈中执行，所以本质上来说 JS 中的异步还是同步行为")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script start'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'setTimeout'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script end'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("不同的任务源会被分配到不同的 "),a("code",[t._v("Task")]),t._v(" 队列中，任务源可以分为 微任务（"),a("code",[t._v("microtask")]),t._v("） 和 宏任务（"),a("code",[t._v("macrotask")]),t._v("）。在 "),a("code",[t._v("ES6")]),t._v(" 规范中，"),a("code",[t._v("microtask")]),t._v("称为 "),a("code",[t._v("jobs")]),t._v("，"),a("code",[t._v("macrotask")]),t._v(" 称为 "),a("code",[t._v("task")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script start'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'setTimeout'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Promise'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'promise1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'promise2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'script end'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// script start => Promise => script end => promise1 => promise2 => setTimeout")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("以上代码虽然 "),a("code",[t._v("setTimeout")]),t._v("写在 "),a("code",[t._v("Promise")]),t._v(" 之前，但是因为 "),a("code",[t._v("Promise")]),t._v("属于微任务而 "),a("code",[t._v("setTimeout")]),t._v(" 属于宏任务")])]),t._v(" "),a("h3",{attrs:{id:"_4-2-微任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-微任务"}},[t._v("#")]),t._v(" 4.2 微任务")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("process.nextTick")])]),t._v(" "),a("li",[a("code",[t._v("promise")])]),t._v(" "),a("li",[a("code",[t._v("Object.observe")])]),t._v(" "),a("li",[a("code",[t._v("MutationObserver")])])]),t._v(" "),a("h3",{attrs:{id:"_4-3-宏任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-宏任务"}},[t._v("#")]),t._v(" 4.3 宏任务")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("script")])]),t._v(" "),a("li",[a("code",[t._v("setTimeout")])]),t._v(" "),a("li",[a("code",[t._v("setInterval")])]),t._v(" "),a("li",[a("code",[t._v("setImmediate")])]),t._v(" "),a("li",[a("code",[t._v("I/O")])]),t._v(" "),a("li",[a("code",[t._v("UI rendering")])])]),t._v(" "),a("blockquote",[a("p",[t._v("宏任务中包括了 "),a("code",[t._v("script")]),t._v(" ，浏览器会先执行一个宏任务，接下来有异步代码的话就先执行微任务")])]),t._v(" "),a("h3",{attrs:{id:"_4-4-正确的event-loop-顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-正确的event-loop-顺序"}},[t._v("#")]),t._v(" 4.4 正确的Event loop 顺序")]),t._v(" "),a("ul",[a("li",[t._v("执行同步代码，这属于宏任务")]),t._v(" "),a("li",[t._v("执行栈为空，查询是否有微任务需要执行")]),t._v(" "),a("li",[t._v("执行所有微任务")]),t._v(" "),a("li",[t._v("必要的话渲染 "),a("code",[t._v("UI")])]),t._v(" "),a("li",[t._v("然后开始下一轮 "),a("code",[t._v("Event loop")]),t._v("，执行宏任务中的异步代码")])]),t._v(" "),a("blockquote",[a("p",[t._v("通过上述的 "),a("code",[t._v("Event loop")]),t._v(" 顺序可知，如果宏任务中的异步代码有大量的计算并且需要操作 "),a("code",[t._v("DOM")]),t._v(" 的话，为了更快的响应界面响应，我们可以把操作 "),a("code",[t._v("DOM")]),t._v(" 放入微任务中")])]),t._v(" "),a("h2",{attrs:{id:"五、node-中的-event-loop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、node-中的-event-loop"}},[t._v("#")]),t._v(" 五、Node 中的 Event loop")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Node.js")]),t._v("也是单线程的"),a("code",[t._v("Event Loop")]),t._v("，但是它的运行机制不同于浏览器环境")]),t._v(" "),a("li",[a("code",[t._v("Node")]),t._v(" 的 "),a("code",[t._v("Event loop")]),t._v(" 分为"),a("code",[t._v("6")]),t._v("个阶段，它们会按照顺序反复运行")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://poetries1.gitee.io/img-repo/2019/10/318.png",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"_5-1-node-js的运行机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-node-js的运行机制"}},[t._v("#")]),t._v(" 5.1 Node.js的运行机制")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("V8")]),t._v("引擎解析"),a("code",[t._v("JavaScript")]),t._v("脚本")]),t._v(" "),a("li",[t._v("解析后的代码，调用"),a("code",[t._v("Node API")])]),t._v(" "),a("li",[a("code",[t._v("libuv")]),t._v("库负责"),a("code",[t._v("Node API")]),t._v("的执行。它将不同的任务分配给不同的线程，形成一个"),a("code",[t._v("Event Loop")]),t._v("（事件循环），以异步的方式将任务的执行结果返回给V8引擎")]),t._v(" "),a("li",[a("code",[t._v("V8")]),t._v("引擎再将结果返回给用户")])]),t._v(" "),a("blockquote",[a("p",[t._v("除了"),a("code",[t._v("setTimeout")]),t._v("和"),a("code",[t._v("setInterval")]),t._v("这两个方法，"),a("code",[t._v("Node.js")]),t._v('还提供了另外两个与"任务队列"有关的方法：'),a("code",[t._v("process.nextTick")]),t._v("和s"),a("code",[t._v("etImmediate")]),t._v('。它们可以帮助我们加深对"任务队列"的理解')])]),t._v(" "),a("h3",{attrs:{id:"_5-2-各个阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-各个阶段"}},[t._v("#")]),t._v(" 5.2 各个阶段")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("┌───────────────────────┐\n┌─>│        timers         │\n│  └──────────┬────────────┘\n│  ┌──────────┴────────────┐\n│  │     I/O callbacks     │\n│  └──────────┬────────────┘\n│  ┌──────────┴────────────┐\n│  │     idle, prepare     │\n│  └──────────┬────────────┘      ┌───────────────┐\n│  ┌──────────┴────────────┐      │   incoming:   │\n│  │         poll          │<──connections───     │\n│  └──────────┬────────────┘      │   data, etc.  │\n│  ┌──────────┴────────────┐      └───────────────┘\n│  │        check          │\n│  └──────────┬────────────┘\n│  ┌──────────┴────────────┐\n└──┤    close callbacks    │\n   └───────────────────────┘\n")])])]),a("h4",{attrs:{id:"_5-2-1-timer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-1-timer"}},[t._v("#")]),t._v(" 5.2.1 timer")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("timers")]),t._v(" 阶段会执行 "),a("code",[t._v("setTimeout")]),t._v(" 和 "),a("code",[t._v("setInterval")])]),t._v(" "),a("li",[t._v("一个 "),a("code",[t._v("timer")]),t._v(" 指定的时间并不是准确时间，而是在达到这个时间后尽快执行回调，可能会因为系统正在执行别的事务而延迟")]),t._v(" "),a("li",[t._v("下限的时间有一个范围："),a("code",[t._v("[1, 2147483647]")]),t._v(" ，如果设定的时间不在这个范围，将被设置为"),a("code",[t._v("1")]),t._v("。")])]),t._v(" "),a("h4",{attrs:{id:"_5-2-2-i-o"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-2-i-o"}},[t._v("#")]),t._v(" 5.2.2 I/O")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("I/O")]),t._v(" 阶段会执行除了 "),a("code",[t._v("close")]),t._v(" 事件，定时器和 "),a("code",[t._v("setImmediate")]),t._v(" 的回调")])]),t._v(" "),a("h4",{attrs:{id:"_5-2-3-idle-prepare"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-3-idle-prepare"}},[t._v("#")]),t._v(" 5.2.3 idle, prepare")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("idle")]),t._v(", "),a("code",[t._v("prepare")]),t._v(" 阶段内部实现")])]),t._v(" "),a("h4",{attrs:{id:"_5-2-4-poll"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-poll"}},[t._v("#")]),t._v(" 5.2.4 poll")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("poll")]),t._v(" 阶段很重要，这一阶段中，系统会做两件事情")])]),t._v(" "),a("ul",[a("li",[t._v("执行到点的定时器")]),t._v(" "),a("li",[t._v("执行 "),a("code",[t._v("poll")]),t._v(" 队列中的事件")])]),t._v(" "),a("blockquote",[a("p",[t._v("并且当 poll 中没有定时器的情况下，会发现以下两件事情")])]),t._v(" "),a("ul",[a("li",[t._v("如果 "),a("code",[t._v("poll")]),t._v(" 队列不为空，会遍历回调队列并同步执行，直到队列为空或者系统限制")]),t._v(" "),a("li",[t._v("如果 "),a("code",[t._v("poll")]),t._v(" 队列为空，会有两件事发生\n"),a("ul",[a("li",[t._v("如果有 "),a("code",[t._v("setImmediate")]),t._v(" 需要执行，"),a("code",[t._v("poll")]),t._v(" 阶段会停止并且进入到 "),a("code",[t._v("check")]),t._v(" 阶段执行 "),a("code",[t._v("setImmediate")])]),t._v(" "),a("li",[t._v("如果没有 "),a("code",[t._v("setImmediate")]),t._v(" 需要执行，会等待回调被加入到队列中并立即执行回调")])])]),t._v(" "),a("li",[t._v("如果有别的定时器需要被执行，会回到 "),a("code",[t._v("timer")]),t._v(" 阶段执行回调")])]),t._v(" "),a("h4",{attrs:{id:"_5-2-5-check"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-5-check"}},[t._v("#")]),t._v(" 5.2.5 check")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("check")]),t._v(" 阶段执行 "),a("code",[t._v("setImmediate")])])]),t._v(" "),a("h4",{attrs:{id:"_5-2-6-close-callbacks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-6-close-callbacks"}},[t._v("#")]),t._v(" 5.2.6 close callbacks")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("close callbacks")]),t._v(" 阶段执行 "),a("code",[t._v("close")]),t._v(" 事件")]),t._v(" "),a("li",[t._v("并且在 "),a("code",[t._v("Node")]),t._v(" 中，有些情况下的定时器执行顺序是随机的")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'setTimeout'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setImmediate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'setImmediate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里可能会输出 setTimeout，setImmediate")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可能也会相反的输出，这取决于性能")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 因为可能进入 event loop 用了不到 1 毫秒，这时候会执行 setImmediate")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 否则会执行 setTimeout")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("当然在这种情况下，执行顺序是相同的")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nfs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__filename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timeout'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setImmediate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'immediate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 因为 readFile 的回调在 poll 中执行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 发现有 setImmediate ，所以会立即跳到 check 阶段执行回调")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 再去 timer 阶段执行 setTimeout")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所以以上输出一定是 setImmediate，setTimeout")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("上面介绍的都是"),a("code",[t._v("macrotask")]),t._v(" 的执行情况，"),a("code",[t._v("microtask")]),t._v(" 会在以上每个阶段完成后立即执行。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timer1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'promise1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timer2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'promise2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以上代码在浏览器和 node 中打印情况是不同的")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 浏览器中一定打印 timer1, promise1, timer2, promise2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// node 中可能打印 timer1, timer2, promise1, promise2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 也可能打印 timer1, promise1, timer2, promise2")]),t._v("\n")])])]),a("blockquote",[a("p",[a("code",[t._v("Node")]),t._v(" 中的 "),a("code",[t._v("process.nextTick")]),t._v(" 会先于其他 "),a("code",[t._v("microtask")]),t._v(" 执行。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"timer1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"promise1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nprocess"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nextTick"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// nextTick, timer1, promise1")]),t._v("\n")])])]),a("h2",{attrs:{id:"六、参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、参考"}},[t._v("#")]),t._v(" 六、参考")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2014/10/event-loop.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript 运行机制详解：再谈Event Loop"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);